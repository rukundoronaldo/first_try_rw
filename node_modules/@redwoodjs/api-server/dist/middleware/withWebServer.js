"use strict";

var _Object$defineProperty = require("@babel/runtime-corejs3/core-js/object/define-property");

var _interopRequireDefault = require("@babel/runtime-corejs3/helpers/interopRequireDefault").default;

_Object$defineProperty(exports, "__esModule", {
  value: true
});

exports.default = void 0;

var _fs = _interopRequireDefault(require("fs"));

var _path = _interopRequireDefault(require("path"));

var _express = _interopRequireDefault(require("express"));

var _internal = require("@redwoodjs/internal");

const withWebServer = app => {
  const indexContent = _fs.default.readFileSync(_path.default.join((0, _internal.getPaths)().web.dist, '/index.html'), 'utf-8');

  app.use(_express.default.static((0, _internal.getPaths)().web.dist, {
    redirect: false
  })); // For SPA routing on unmatched routes

  app.get('*', function (_, response) {
    response.send(indexContent);
  });
  return app;
};

var _default = withWebServer;
exports.default = _default;